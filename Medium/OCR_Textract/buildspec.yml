version: 0.2

phases:
  pre_build:
    commands:
      - echo "Running pre build commands"
      - wget -qO - https://raw.githubusercontent.com/yarnpkg/releases/gh-pages/debian/pubkey.gpg | apt-key add -
      - apt-get update
      - apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 7EA0A9C3F273FCD8
      - add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu bionic stable"
      - apt-get -y install docker-ce docker-ce-cli containerd.io
      - npm install -g serverless --unsafe
      - npm i -D serverless-dotenv-plugin
      - npm install serverless-plugin-aws-alerts --save-dev
      - sls plugin install -n serverless-python-requirements
      - sls plugin install -n serverless-plugin-aws-alerts
      - apt-get -y install python3-pip
      - pip3 install --upgrade pip
      - pip3 install awscli --upgrade --user
      - apt-get install python3-setuptools
  build:
    commands:
      - echo "Running build commands"
      - sls deploy --region ""
